<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="images/cmd-icon.png" type="image/x-icon">

    <!-- GOOGLE FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@300&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="images/icons/titlebar/terminal-icon.png" type="image/x-icon">

    <!-- jQuery stuff -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
    integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8="
    crossorigin="anonymous"></script>
    
    <title>&gt; TERMINAL</title>

    
</head>
<body id="body">
    <script>
        function refreshTime() 
        {
            const timeDisplay = document.getElementById("time");
            const dateDisplay = document.getElementById("date");
            const dateString = new Date().toLocaleString();
            const formattedString = dateString.split(",");
            timeDisplay.textContent = formattedString[1];
            dateDisplay.textContent = formattedString[0];
        }
        setInterval(refreshTime, 1000);
        var date = new Date().getDate();
        var time = new Date().getDate();
    
    </script>
    <!-- <header class="page-title">
        <section>
            <h1>&gt; TERMINAL</h1>
        </section>
        <section>
            <div class="page-login"></div>
            <div class="page-signup"></div>
        </section>
        
        
    </header> -->

    <main>
        <article id="desktop">  
            
            <div id="datetime">
                <div id="taskbar"></div>
                <div id="time"></div>
                <div id="date"></div>
            </div>
        </article>
        
    </main>

    <footer></footer>

    <script type="module">

        import Vec2 from "./modules/Vec2.mjs";
        import BaseWindow from "./modules/BaseWindow.mjs";
        import Terminal from "./modules/Terminal.mjs";
        import Desktop from "./modules/Desktop.mjs";
        import NameTree from "./modules/NameTree.mjs";
        import FileSystem from "./modules/FileSystem.mjs";
        import Pong from "./modules/Pong.mjs";
        import FlappyBird from "./modules/FlappyBird.mjs";
        import ResourceManager from "./modules/ResourceManager.mjs"

        // Tree testing
        /*
        const testTree = new NameTree(new FileData("C:"), "C:");
        testTree.addChild("Program Files", new FileData("Program Files"));
        testTree.addChild("Users", new FileData("Users"));
        testTree.addChild("Windows", new FileData("Windows"));
        testTree.addChild("defaultuser0", new FileData("defaultuser0"), ["Users"]);
        testTree.addChild("Mike Oxmall", new FileData("Mike Oxmall"), ["Users"]);
        testTree.moveTo(["Users"]);
        testTree.addChild("Mike Oxbig", new FileData("Mike Oxbig"));
        testTree.moveTo(["Mike Oxbig"]);
        testTree.addChild("Photos", new FileData("Photos"));
        testTree.addChildAbsolute("System32", new FileData("System32"), ["Windows"]);
        testTree.printLevels();
        testTree.moveTo(["Photos"]);
        testTree.moveToAbsolute();
        console.log(testTree.getCurrentPath().join('\\') + '>');
        var testSystem = new FileSystem(testTree);

        $.ajax({
            url: "map1.txt",
            dataType: "text",
            success: function(data){
                console.log(data);
                testSystem.loadFromFile(data);
            }
        });
        */


        $(function() {

        const fileText = ResourceManager.readFile("map1.txt");
        const testSystem = new FileSystem();
        testSystem.loadFromFile(fileText);

        
    
    // Webpage setup
        const desktop = document.getElementById("desktop");
        const game = new Desktop(desktop);

        const terminal = new Terminal(desktop, 0, testSystem);
        const pong = new Pong(desktop, 1);
        const flappybird = new FlappyBird(desktop, 2);

        game.registerWindow(terminal.getBaseWindow());
        game.registerWindow(pong.getBaseWindow());
        game.registerWindow(flappybird.getBaseWindow());
    });
    </script>
</body>
</html>


